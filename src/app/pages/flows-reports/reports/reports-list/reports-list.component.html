<div class="row m-0 p-4">
  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 mt-2 mb-5 text-center">
    <span class="txt-titulo">{{textState}}</span>
  </div>

  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 m-0 p-0 text-center">
    <div class="row m-0 p-0">

      <div class="col-xxl-3 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-12 m-0 pl-4">
       
        <p-calendar #dateFilter [maxDate]="minDate" (onSelect)="onDatesRangeFilterSelected($event)"
          [(ngModel)]="rangeDates" selectionMode="range" [readonlyInput]="true" pTooltip="Rango de Fechas"
          [numberOfMonths]="2" [readonlyInput]="true" [showIcon]="true"></p-calendar>
      </div>
      <div *ngIf="textState === 'Reporte Vuelos'" class="col-xxl-3 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-12 m-0 pl-4">
        <p-dropdown *ngIf="validDrop" [options]="listViews" [(ngModel)]="selectedView" (onChange)="getReportFligth()"
          optionLabel="nameView" optionValue="companyReportId" placeholder="Mostras todos"></p-dropdown>
      </div>
      <div *ngIf="textState === 'Reporte Vuelos'" class="col-xxl-3 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-12 m-0 pl-4">
        <p-button label="Nueva vista" (onClick)="getField(true)" [outlined]="true" severity="danger"></p-button>
      </div>
      <div *ngIf="textState === 'Reporte Vuelos'" class="col-xxl-3 col-xl-3 col-lg-3 col-md-6 col-sm-6 col-12 m-0 pl-4">
        <p-button label="Modificar vista" [outlined]="true" (onClick)="getField(false)" [disabled]="selectedView === 0 ? true : false" severity="danger" ></p-button>
      </div>
    </div>

  </div>

  <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 mt-3 ">
    <div *ngIf="!visible" class="row m-0 p-0">

      <p-table id="table-data-report" #dt1 [columns]="selectedColumns" [value]="listReports" [scrollable]="true"
        scrollHeight="600px" [globalFilterFields]="lstTextFilter">

        <ng-template pTemplate="caption">


          <div class="table-header">

            <span class="p-input-icon-left">
              <i class="pi pi-search"></i>
              <input pInputText type="text" (input)="dt1.filterGlobal($any($event.target).value, 'contains')"
                placeholder="{{textPlaceHolder}}"  pTooltip="Filtro de busqueda"/>
            </span>
            <button type="button" pButton pRipple icon="pi pi-file-excel" style="float: right;" (click)="exportAsXLSX()"
              class="p-button-success mr-2" pTooltip="Descargar excel" tooltipPosition="bottom"></button>
          </div>

          <div class="flex m-0 mt-3">
            <p-multiSelect [options]="cols" [(ngModel)]="selectedColumns" optionLabel="header"
              selectedItemsLabel="{0} columnas seleccionadas" [style]="{'min-width': '200px'}"
              placeholder="Gestiona columnas"></p-multiSelect>



          </div>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>

            <th *ngFor="let col of columns" style="min-width: 200px">
              {{col.header}}
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product let-columns="columns">
          <tr>

            <td *ngFor="let col of columns">
              {{product[col.field]}}
            </td>
          </tr>
        </ng-template>

      </p-table>

    </div>
  </div>
</div>


<p-dialog header="{{selectedView === 0 ? 'Nueva vista' : 'Modificar vista'}}" [(visible)]="visible" [blockScroll]="true" [closeOnEscape]="false" [modal]="true" [style]="{ width: '800px', height: '900px' }" [maximizable]="true"
    [draggable]="false" [resizable]="false">
    <div class="container">
        <app-view-management *ngIf="visible"  [todo]="todo" [done]="done" [isRegister]="isRegister" [nameView]="nameView" [companyReportId]="companyReportId" (select)="successReportEvent($event)"></app-view-management>
    </div>
</p-dialog>



<p-toast position="top-center" key="tc"></p-toast>


<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="medium" color="#fff" type="ball-spin-fade-rotating"
  style="width: 100% !important; height: 100% !important;"></ngx-spinner>